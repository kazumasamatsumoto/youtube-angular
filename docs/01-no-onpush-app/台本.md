# 台本：ChangeDetectionStrategy.OnPushを全く使わないアプリケーション

## 📺 動画情報
- **タイトル**: ChangeDetectionStrategy.OnPushを全く使わないアプリケーション【でも動くんだよね】
- **カテゴリ**: Angular
- **想定時間**: 約10-15分
- **合言葉**: 「でも動くんだよね」

---

## 🎬 パート1: 導入（30秒）

### 画面構成
- チャンネルロゴ/タイトルカード
- サムネイル画像（警告マークと「でも動くんだよね」の文字）

### セリフ

**「こんにちは、Angularクソチャンネルです！」**

**「今日は、ChangeDetectionStrategy.OnPushを全く使わないアプリケーションを作ってみました。」**

**「パフォーマンスがどれだけ悪化するか、実演してみます。」**

**「でも動くんだよね、という結論に至る予定です。それでは、いってみましょう！」**

---

## 🎬 パート2: 実装パート（5-10分）

### 2-1. プロジェクトの紹介（1分）

### 画面構成
- IDE（VS Code）でプロジェクトを開く
- プロジェクト構造を表示

### セリフ

**「まず、今回作成したアプリケーションを見てみましょう。」**

**「このアプリは、意図的にOnPushを使わずに実装しています。」**

**「全コンポーネントがデフォルトのChangeDetectionStrategyを使用しています。」**

**「本来は、パフォーマンス最適化のためにOnPushを使うべきなんですが、今回はあえて使いません。」**

### 2-2. コンポーネントの実装（3-5分）

### 画面構成
- コードエディタで各コンポーネントのコードを表示
- 重要な部分をハイライト

### セリフ

**「まず、親コンポーネントから見てみましょう。」**

**「このコンポーネントには、ChangeDetectionStrategy.OnPushが指定されていません。」**

**「コメントで『注意: OnPushを使っていない！これがクソ実装のポイント』と書いてあります。」**

**「本来は、changeDetection: ChangeDetectionStrategy.OnPush を使うべきなんです。」**

**「次に、子コンポーネントを見てみます。」**

**「この子コンポーネントも、OnPushを使っていません。」**

**「親コンポーネントが変更検知されるたびに、この子コンポーネントも再評価されます。」**

**「しかも、50個の子コンポーネントを生成しています。」**

**「つまり、親が1回変更検知されると、子コンポーネントが50回再評価されるんです。」**

**「さらに、各子コンポーネントで、毎回重い計算を実行しています。」**

**「このcalculateExpensiveValueメソッドは、1000回のループでランダムな値を計算しています。」**

**「OnPushを使っていれば、この計算は不要な時に実行されないんですが...」**

**「今回は、変更検知のたびに毎回実行されます。」**

### 2-3. パフォーマンスモニターの実装（2-3分）

### 画面構成
- ChangeDetectionCounterサービスのコードを表示
- PerformanceMonitorコンポーネントのコードを表示

### セリフ

**「変更検知の回数をカウントするサービスを作りました。」**

**「各コンポーネントが変更検知されるたびに、このサービスに記録されます。」**

**「パフォーマンスモニターコンポーネントで、リアルタイムに変更検知の回数を表示します。」**

**「これで、どれだけ無駄な変更検知が発生しているか、視覚的に確認できます。」**

### 2-4. 正しい実装との比較（1-2分）

### 画面構成
- 正しい実装のコード例を表示（サイドバイサイド比較）

### セリフ

**「本来の正しい実装では、このようにOnPushを指定します。」**

**「OnPushを使うことで、入力プロパティやイベントが発生した時だけ変更検知が実行されます。」**

**「これにより、不要な変更検知が大幅に削減され、パフォーマンスが向上します。」**

**「でも、今回は使わないので、パフォーマンスがどれだけ悪化するか見てみましょう。」**

---

## 🎬 パート3: 実行パート（2-3分）

### 3-1. アプリの起動（30秒）

### 画面構成
- ブラウザでアプリを開く
- パフォーマンスモニターが表示される

### セリフ

**「それでは、アプリを起動してみます。」**

**「起動しました。パフォーマンスモニターが表示されています。」**

**「現在、変更検知の回数は0回です。」**

### 3-2. パフォーマンスの悪化を実演（1-2分）

### 画面構成
- パフォーマンスモニターの数値が増えていく様子を撮影
- ブラウザの開発者ツール（Performanceタブ）を開く

### セリフ

**「アプリを起動して、数秒経過しました。」**

**「パフォーマンスモニターを見てください。」**

**「変更検知の回数が、すでに数千回に達しています！」**

**「わずか数秒で、これだけの変更検知が発生しています。」**

**「コンポーネント別に見ると、Childコンポーネントが大量に再評価されています。」**

**「50個の子コンポーネントが、親の変更検知のたびに、毎回再評価されているんです。」**

**「ブラウザの開発者ツールで、パフォーマンスを確認してみます。」**

**「CPU使用率が高くなっていますね。」**

**「変更検知が頻繁に発生していることが、パフォーマンスグラフからも分かります。」**

**「カウンターコンポーネントは、50msごとに自動でカウントアップしています。」**

**「これにより、さらに頻繁に変更検知が発生しています。」**

**「親コンポーネントのタイマーは、100msごとに更新されています。」**

**「これらの組み合わせで、大量の変更検知が発生しているんです。」**

### 3-3. 問題点の紹介（30秒-1分）

### 画面構成
- 各コンポーネントの再描画回数を表示
- コンソールにエラーが出ていないことを確認

### セリフ

**「各子コンポーネントの再描画回数を見てください。」**

**「すでに数百回、再描画されています。」**

**「でも、エラーは出ていません。」**

**「アプリは正常に動作しています。」**

**「でも動くんだよね。」**

**「ただし、パフォーマンスは最悪です。」**

---

## 🎬 パート4: まとめ（1-2分）

### 画面構成
- パフォーマンスモニターの最終的な数値を表示
- 正しい実装へのリンクを表示
- 次回予告

### セリフ

**「というわけで、ChangeDetectionStrategy.OnPushを全く使わないアプリケーションを作ってみました。」**

**「結果として、数秒で数千回の変更検知が発生し、パフォーマンスが著しく悪化しました。」**

**「でも、アプリは正常に動作しています。」**

**「でも動くんだよね。」**

**「実際のプロダクションでは、必ずOnPushを使用してください。」**

**「正しい使い方については、説明欄にリンクを貼っておきます。」**

**「次回は、RxJSのsubscribe地獄を作ってみます。」**

**「ネストしたsubscribeを10階層まで作って、メモリリークを実演します。」**

**「でも動くんだよね、という結論に至る予定です。」**

**「チャンネル登録と高評価、よろしくお願いします！」**

**「それでは、また次回！」**

---

## 📝 補足メモ

### 強調すべきポイント
1. **意図的にOnPushを使わない**ことを明確に
2. **パフォーマンスの悪化**を数値で示す
3. **エラーは出ない**（でも動く）ことを強調
4. **正しい実装方法**へのリンクを提供

### 撮影時の注意点
- パフォーマンスモニターの数値が増えていく様子をしっかり撮影
- ブラウザの開発者ツールの画面も撮影
- コードの重要な部分をハイライトして表示
- 「でも動くんだよね」のフレーズを強調

### BGM・効果音
- 導入部分：明るいBGM
- 実装パート：落ち着いたBGM
- 実行パート：緊張感のあるBGM（数値が増えていく様子）
- まとめ：明るいBGM

---

**「でも動くんだよね」を合言葉に、Angularのクソ実装を楽しみながら学ぶ！**
